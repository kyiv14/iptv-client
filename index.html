<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–æ—Å—Ç—É–ø–Ω–æ–µ IPTV | –í—Ö–æ–¥ –∏ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
    
    <meta property="og:title" content="–î–æ—Å—Ç—É–ø–Ω–æ–µ IPTV | –í—Ö–æ–¥ –∏ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è" />
    <meta property="og:description" content="4000 –∫–∞–Ω–∞–ª–æ–≤ IPTV –≤ –æ—Ç–ª–∏—á–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ —Å –∞—Ä—Ö–∏–≤–æ–º. –í—Ö–æ–¥ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è." />
    <meta property="og:url" content="https://iptvclient.vercel.app/" />
    <meta property="og:image" content="https://iptvclient.vercel.app/iptv.png" />
    <meta property="og:type" content="website" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700;900&display=swap" rel="stylesheet">
    
    <link rel="icon" href="https://iptvclient.vercel.app/icon.ico">
    
    <style>
        :root {
            --system-blue: #007AFF;
            --system-gray-light: #F2F2F7;
            --system-green: #34C759;
            --system-red: #FF3B30;
            --system-purple: #5856D6;
            --blue-hover: #0056b3;
            --green-hover: #218838;
            --purple-hover: #4341A5;
            --qr-color: #333;
            --text-dark: #333;
            --text-light: #666;
        }

        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –∏ —Ñ–æ–Ω */
        html {
            box-sizing: border-box;
        }
        *, *:before, *:after {
            box-sizing: inherit;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: #FFFFFF;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: #333;
            flex-direction: column;
            position: relative;
            overflow-x: hidden; 
        }

        .page-wrapper {
            width: 100%;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        /* –ê–ù–ò–ú–ê–¶–ò–Ø –ü–û–Ø–í–õ–ï–ù–ò–ô –≠–õ–ï–ú–ï–ù–¢–û–í */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        /* –ö–û–ù–¢–ï–ô–ù–ï–† –û–°–ù–û–í–ù–û–ì–û –ö–û–ù–¢–ï–ù–¢–ê (–ù–ê–°–¢–û–õ–¨–ù–´–ô) */
        .main-content {
            max-width: 700px;
            text-align: center;
            padding: 20px;
            opacity: 0;
            animation: fadeIn 0.8s ease-out forwards;
            animation-delay: 0.2s;
        }

        .main-content h1 {
            font-size: 38px;
            color: var(--system-blue);
            margin-bottom: 20px;
            font-weight: 700;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .main-content p {
            font-size: 18px;
            color: #555;
            line-height: 1.6;
            margin-bottom: 20px; 
        }
        
        /* =================================================== */
        /* –°–¢–ò–õ–ò –ë–õ–û–ö–ê "–ö–ê–ö –ü–û–î–ö–õ–Æ–ß–ò–¢–¨ IPTV" */
        /* =================================================== */
        .how-to-connect-block {
            max-width: 1000px;
            width: 100%;
            padding: 30px 20px;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            opacity: 0;
            animation: fadeIn 0.8s ease-out forwards;
            animation-delay: 0.5s;
            margin-top: 40px;
            margin-bottom: 40px; 
        }

        .how-to-connect-block h2 {
            font-size: 28px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 40px;
            color: #333;
        }

        .steps-container {
            display: flex;
            justify-content: space-around;
            gap: 20px;
            flex-wrap: wrap;
        }

        .step-item {
            flex-basis: 200px; 
            text-align: center;
            padding: 10px;
            transition: transform 0.3s ease;
        }
        
        .step-item:hover {
            transform: translateY(-5px);
        }

        .step-number {
            width: 40px;
            height: 40px;
            line-height: 40px;
            background: var(--system-blue); 
            color: white;
            border-radius: 50%;
            font-size: 20px;
            font-weight: 900;
            margin: 0 auto 15px;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.4);
            transition: transform 0.3s ease;
        }
        
        .step-item:hover .step-number {
            transform: scale(1.1);
        }

        .step-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--system-blue);
            margin-bottom: 5px;
            text-transform: uppercase;
        }

        .step-description {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
            line-height: 1.4;
        }

        .step-description a {
             color: var(--system-blue);
             text-decoration: none;
             font-weight: 600;
             transition: color 0.2s ease;
        }
        
        .step-description a:hover {
             color: var(--blue-hover);
             text-decoration: underline;
        }

        /* =================================================== */
        /* –°–¢–ò–õ–ò –ë–õ–û–ö–ê "–ì–î–ï –†–ê–ë–û–¢–ê–ï–¢ IPTV?" */
        /* =================================================== */
        .where-it-works-block {
            max-width: 1000px;
            width: 100%;
            padding: 30px 20px;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            opacity: 0;
            animation: fadeIn 0.8s ease-out forwards;
            animation-delay: 0.8s;
            margin-bottom: 40px;
        }

        .where-it-works-block h2 {
            font-size: 28px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 40px;
            color: #333;
        }

        .devices-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px 20px;
            justify-items: center;
            padding: 0 5%;
        }

        .device-item {
            text-align: center;
            padding: 10px;
            transition: transform 0.3s ease;
        }
        
        .device-item:hover {
            transform: translateY(-5px);
        }

        .device-icon {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--system-blue); 
            margin: 0 auto 10px;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.4);
        }
        
        .device-icon img {
            width: 70%;
            height: 70%;
            object-fit: contain;
        }

        .device-name {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            text-transform: uppercase;
            margin-top: 5px;
        }
        
        /* =================================================== */
        /* –°–¢–ò–õ–ò –ë–õ–û–ö–ê –ü–õ–ï–ô–õ–ò–°–¢–ê (–ü–û–°–õ–ï –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò) */
        /* =================================================== */
        .post-auth-layout {
            display: none;
            justify-content: center;
            max-width: 1200px;
            width: 100%;
            gap: 30px;
            margin-top: 50px;
            margin-bottom: 50px;
            animation: fadeInScale 0.6s ease-out forwards;
        }

        .playlist-info-page,
        .payment-block {
            background: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            flex: 1; 
            min-width: 300px;
            text-align: center;
        }
        
        .playlist-info-page { display: block; }
        .payment-block { display: block; }
        
        .client-greeting {
            color: var(--system-blue);
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .playlist-info-page h2 {
            color: #333;
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 25px;
        }

        .expiration-info {
            font-size: 18px;
            font-weight: 600;
            color: var(--system-red);
            margin-bottom: 25px;
        }

        .playlist-link-box {
            background: var(--system-gray-light);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
            word-break: break-all;
            font-size: 16px;
            font-weight: 500;
        }
        
        .playlist-info-actions {
            display: flex;
            gap: 12px;
            flex-direction: column;
            width: 100%;
            max-width: 300px; 
            margin: 0 auto;
        }

        .playlist-info-actions button {
            width: 100%;
            font-size: 20px; 
            padding: 15px;
            border-radius: 8px;
            color: white; 
            font-weight: 700;
            border: none;
            outline: none;
            cursor: pointer;
            transition: background 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease; 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .playlist-info-actions button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        
        .playlist-info-actions button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        #copyLinkBtnPage:hover { background: var(--blue-hover) !important; }
        #downloadLinkBtnPage:hover { background: var(--green-hover) !important; }

        /* –°–¢–ò–õ–ò –ë–õ–û–ö–ê –û–ü–õ–ê–¢–´ */
        .payment-block h2 {
            color: var(--system-green);
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .card-number-display {
            background: var(--system-gray-light);
            padding: 15px;
            border-radius: 8px;
            margin: 0 auto 20px;
            font-size: 22px;
            font-weight: 700;
            color: #333;
            max-width: 300px;
            overflow-wrap: break-word; 
        }

        .payment-amount {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
        }

        .submit-btn-modern {
            width: 100%;
            max-width: 300px;
            margin: 0 auto;
            padding: 15px;
            border: none;
            border-radius: 8px;
            background: var(--system-blue); 
            color: white;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.4);
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
            z-index: 1;
            display: block;
        }

        .payment-btn {
            background: var(--system-green) !important;
            box-shadow: 0 4px 15px rgba(52, 199, 89, 0.4) !important;
            margin-top: 10px; 
        }
        
        .payment-btn:hover {
            background: var(--green-hover) !important;
            box-shadow: 0 8px 25px rgba(52, 199, 89, 0.6) !important;
        }
        
        .copy-card-btn {
            background: var(--system-blue);
            color: white;
            font-weight: 700;
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s ease, transform 0.1s ease;
            font-size: 16px;
            width: 100%; 
            max-width: 300px;
            margin: 0 auto; 
            display: block; 
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.4); 
        }
        
        .copy-card-btn:hover {
            background: var(--blue-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 123, 255, 0.5);
        }
        
        .copy-card-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.4);
        }

        /* =================================================== */
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        /* =================================================== */
        @media (max-width: 900px) {
            .post-auth-layout { flex-direction: column; gap: 40px; }
        }
        @media (max-width: 768px) {
            .devices-container { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 500px) {
            .devices-container { grid-template-columns: 1fr; }
            .main-content { margin-top: 80px; }
            .main-content h1 { font-size: 32px; line-height: 1.2; }
            .main-content p { font-size: 18px; }
            .how-to-connect-block h2, .where-it-works-block h2 { font-size: 24px; }
            .step-title, .device-name { font-size: 16px; }
            .step-description { font-size: 15px; }
            .steps-container { gap: 30px; }
            .step-item { flex-basis: 90%; }
            .auth-buttons-container { top: 10px; right: 10px; }
            .admin-button-container { top: 10px; left: 10px; }
            .client-greeting { font-size: 24px; }
            .playlist-info-page h2 { font-size: 18px; }
            .card-number-display { font-size: 20px; }
            .playlist-info-actions, .copy-card-btn, .submit-btn-modern { max-width: 90%; }
            #loginModal .input-group-modern, #registrationModal .input-group-modern { max-width: none; }
        }

        /* =================================================== */
        /* –ö–ù–û–ü–ö–ò –ù–ê–í–ò–ì–ê–¶–ò–ò */
        /* =================================================== */
        .channel-list-btn {
            display: inline-block;
            margin-top: 20px;
            margin-bottom: 30px;
            padding: 18px 36px;
            background: var(--system-blue);
            color: white;
            font-size: 22px;
            font-weight: 700;
            border-radius: 10px;
            text-decoration: none;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.4);
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        .channel-list-btn:hover {
            background: var(--blue-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 123, 255, 0.5);
        }

        .admin-button-container {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 110;
        }

        .auth-buttons-container {
            position: fixed; 
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 110;
        }
        
        .auth-btn {
            padding: 12px 18px;
            border: none;
            border-radius: 8px;
            background: var(--system-blue);
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: background 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease, opacity 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.4);
            display: block; 
            opacity: 1;
            text-decoration: none;
        }
        .auth-btn:hover {
            background: var(--blue-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 123, 255, 0.5);
        }
        .auth-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.4);
        }

        .admin-btn {
            background-color: var(--system-purple);
            box-shadow: 0 4px 10px rgba(88, 86, 214, 0.4);
        }
        .admin-btn:hover {
            background-color: var(--purple-hover);
            box-shadow: 0 6px 15px rgba(88, 86, 214, 0.5);
        }
        
        #logoutBtn {
             background-color: var(--system-red) !important;
             box-shadow: 0 4px 10px rgba(255, 59, 48, 0.4) !important;
             transition: opacity 0.3s ease, background 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
             display: none; 
             opacity: 0;
        }
        #logoutBtn:hover {
             background-color: #cc0000 !important;
             box-shadow: 0 6px 15px rgba(255, 59, 48, 0.5) !important;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 100;
            justify-content: center;
            align-items: center;
            padding: 20px 0;
            overflow-y: auto;
        }
        
        @keyframes modalOpen {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-content {
            background: white;
            width: 80%;
            max-width: 400px;
            border-radius: 14px;
            padding: 25px;
            animation: modalOpen 0.3s ease-out;
            position: relative;
        }
        
        .close-btn {
            position: absolute;
            top: -15px;
            right: -15px;
            width: 35px;
            height: 35px;
            line-height: 35px;
            text-align: center;
            font-size: 28px;
            color: white;
            background: var(--system-blue);
            border-radius: 50%;
            cursor: pointer;
            opacity: 0.9;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s ease, opacity 0.2s ease, background 0.2s ease;
            font-weight: 300;
            z-index: 10;
        }
        .close-btn:hover {
            opacity: 1;
            transform: scale(1.1);
            background: var(--system-red);
        }
        
        #registrationModal .close-btn,
        #loginModal .close-btn {
            top: 10px;
            right: 10px;
        }

        /* INPUTS AND STATUS MESSAGES */
        .input-group-modern { position: relative; margin-bottom: 35px; }
        .input-group-modern input {
            width: 100%;
            padding: 15px 10px 5px 10px;
            background: none;
            border: none;
            border-bottom: 2px solid #ccc;
            font-size: 16px;
            color: #333;
            outline: none;
            transition: border-bottom-color 0.3s ease;
        }
        .input-group-modern input:focus,
        .input-group-modern input:not(:placeholder-shown) {
            border-bottom-color: var(--system-blue);
        }
        .input-group-modern label {
            position: absolute;
            top: 15px;
            left: 10px;
            color: #999;
            font-size: 16px;
            pointer-events: none;
            transition: all 0.3s ease;
        }
        .input-group-modern input:focus + label,
        .input-group-modern input:not(:placeholder-shown) + label {
            top: -10px;
            left: 0;
            font-size: 12px;
            color: var(--system-blue);
        }
        
        #loginModal .input-group-modern,
        #registrationModal .input-group-modern {
            max-width: 80%; 
            margin: 0 auto 35px; 
        }

        .submit-btn-modern:not(#loginBtn) {
            width: 100%;
            max-width: 300px; 
            margin: 0 auto; 
            display: block;
        }

        #loginBtn,
        #registrationModal .submit-btn-modern {
            width: 100%;
            max-width: 80%;
            margin: 0 auto;
            display: block;
        }
        
        .submit-btn-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 123, 255, 0.6);
        }
        .submit-btn-modern:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(0, 123, 255, 0.4);
        }
        .status-message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            font-size: 15px;
            display: none;
        }
        .status-message.success { background-color: #e6ffe6; color: var(--system-green); }
        .status-message.error { background-color: #ffe6e6; color: var(--system-red); }

        /* =================================================== */
        /* –°–¢–ò–õ–ò –î–õ–Ø –°–¢–†–ê–ù–ò–¶–´ –°–ü–ò–°–ö–ê –ö–ê–ù–ê–õ–û–í (–∏–∑ index01.html) */
        /* =================================================== */
        #channelListPage { width: 100%; }
        #channelListPage header {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            background: white;
            color: var(--system-blue);
            text-align: center;
            font-size: 2rem;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border-bottom: 1px solid #e5e5e5;
        }

        .header-title {
            flex-grow: 1;
            text-align: center;
            padding-right: 90px;
        }
        
        #backToMainBtn {
            padding: 10px 18px;
            font-size: 16px;
            font-weight: 600;
            color: white;
            background: var(--system-blue);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
            width: 90px;
        }
        #backToMainBtn:hover {
            background: var(--blue-hover);
            transform: scale(1.05);
        }

        #channelListPage .search-container {
            padding: 1.5rem 1rem;
            background: white;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        #channelListPage .search-input {
            width: 80%;
            max-width: 1200px; 
            margin: 0 auto;
            display: block;
            padding: 0.9rem 1.2rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1.1rem;
            font-family: 'Montserrat', sans-serif;
            outline: none;
            transition: border-color 0.3s ease, box-shadow 0.3s ease, width 0.3s ease;
        }
        #channelListPage .search-input:focus {
            border-color: var(--system-blue);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
        }
        #channelListPage .categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 1.5rem;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        #channelListPage .category {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 1px solid #e0e0e0;
            animation: fadeIn 0.5s ease-out forwards;
        }
        #channelListPage .category:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        }
        #channelListPage .category-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--system-blue);
            text-transform: uppercase;
            margin-bottom: 8px;
        }
        #channelListPage .category-count {
            font-size: 0.9rem;
            color: var(--text-light);
            font-weight: 500;
        }
        #channelListPage #search-results {
            padding: 1rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        #channelListPage .channel-result {
            padding: 1rem 1.5rem;
            margin-bottom: 1rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.1rem;
            font-weight: 500;
            transition: background-color 0.2s ease, transform 0.2s ease;
            animation: fadeIn 0.4s ease-out forwards;
        }
        #channelListPage .channel-result:hover {
            background-color: #f9f9f9;
            transform: scale(1.02);
        }
        #channelListPage .channel-category {
            font-size: 0.8rem;
            font-weight: 600;
            color: white;
            background: var(--system-blue);
            padding: 0.3rem 0.6rem;
            border-radius: 16px;
            text-transform: uppercase;
        }
        #channelListPage .modal-content {
            background: white;
            width: 90%; /* –ò–ó–ú–ï–ù–ï–ù–ò–ï: –®–∏—Ä–∏–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –∫ 90% */
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            border-radius: 14px;
            padding: 25px;
            position: relative;
            animation: modalOpen 0.3s ease-out;
        }
        
        #channelListPage #channelModal .close-btn {
            top: 15px;
            right: 15px;
        }
        
        #channelListPage .modal h2 {
            margin-top: 0;
            margin-bottom: 2rem;
            color: var(--system-blue);
            font-weight: 700;
            text-transform: uppercase;
            text-align: center;
            font-size: 1.8rem;
        }
        #channelListPage .modal-search {
            width: 80%;
            display: block;
            margin: 0 auto 1.5rem;
            padding: 0.9rem 1.2rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Montserrat', sans-serif;
            outline: none;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        #channelListPage .modal-search:focus {
            border-color: var(--system-blue);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
        }
        #channelListPage #channel-list {
          max-height: 60vh;
          overflow-y: auto;
          padding-right: 10px; /* for scrollbar */
        }
        #channelListPage .channel {
            margin-bottom: 0.5rem;
            padding: 0.8rem 1rem;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 500;
            border-radius: 8px;
            transition: background-color 0.2s ease;
        }
        #channelListPage .channel:hover { background-color: var(--system-gray-light); }
        #channelListPage .channel:last-child { border-bottom: none; }
        
        @media (max-width: 600px) {
            #channelListPage header { 
                font-size: 1.2rem; 
                padding: 1rem;
                justify-content: flex-start;
            }
            .header-title {
                padding-right: 0;
                margin-left: 10px;
            }
            #backToMainBtn { 
                font-size: 14px; 
                padding: 8px 12px;
                width: auto;
            }
            #channelListPage .categories { padding: 1rem; gap: 1rem; }
            #channelListPage #search-results { padding: 1rem; }
            #channelListPage .channel-result { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
            
            #channelListPage .search-container {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    
    <div class="admin-button-container">
        <a href="https://moe-iptv.vercel.app/" class="auth-btn admin-btn">–ê–¥–º–∏–Ω</a>
    </div>

    <div class="auth-buttons-container" id="authButtonsContainer">
        <button class="auth-btn" id="regBtn" onclick="openModal('registrationModal')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        <button class="auth-btn" id="loginBtnNav" onclick="openModal('loginModal')">–í—Ö–æ–¥</button>
        <button class="auth-btn" id="logoutBtn" onclick="logout()">–í—ã—Ö–æ–¥</button>
    </div>

    <div class="page-wrapper">
        <div id="mainPageContent">
            <div class="main-content" id="preAuthContent">
                <h1>–î–æ—Å—Ç—É–ø–Ω–æ–µ IPTV ‚Äî 4000 –∫–∞–Ω–∞–ª–æ–≤ IPTV –≤ –æ—Ç–ª–∏—á–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ —Å –∞—Ä—Ö–∏–≤–æ–º.</h1>
                <p>–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å IPTV —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–Ω–∞–ª—ã –≤ Full HD –∏ Ultra HD –∫–∞—á–µ—Å—Ç–≤–µ. –ü–ª–µ–π–ª–∏—Å—Ç IPTV —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏—è –Ω–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç 4000 IPTV –∫–∞–Ω–∞–ª–æ–≤. –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞–º –∏ –∂–µ–ª–∞–µ–º –í–∞–º –ø—Ä–∏—è—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</p>
                <button class="channel-list-btn" id="showChannelListBtn">–°–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤</button>
            </div>

            <div class="how-to-connect-block" id="howToConnectBlock">
                <h2>–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å IPTV</h2>
                <div class="steps-container">
                    <div class="step-item">
                        <div class="step-number">1</div><div class="step-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
                        <div class="step-description">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É</div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">2</div><div class="step-title">–û–ø–ª–∞—Ç–∞</div>
                        <div class="step-description">–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">3</div><div class="step-title">–ü–ª–µ–π–ª–∏—Å—Ç</div>
                        <div class="step-description">–°–∫–∞—á–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç</div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">4</div><div class="step-title">–ó–∞–≥—Ä—É–∑–∫–∞</div>
                        <div class="step-description">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç –≤ –í–∞—à–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</div>
                    </div>
                </div>
            </div>
            
            <div class="where-it-works-block" id="whereItWorksBlock">
                <h2>–ì–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç IPTV?</h2>
                <div class="devices-container">
                    <div class="device-item">
                        <div class="device-icon"><img src="https://iptvclient.vercel.app/smartphone-call.png" alt="–°–º–∞—Ä—Ç—Ñ–æ–Ω"></div>
                        <div class="device-name">–ù–∞ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–µ</div>
                    </div>
                    <div class="device-item">
                        <div class="device-icon"><img src="https://iptvclient.vercel.app/computer-tablet.png" alt="–ü–ª–∞–Ω—à–µ—Ç"></div>
                        <div class="device-name">–ù–∞ –ø–ª–∞–Ω—à–µ—Ç–µ</div>
                    </div>
                    <div class="device-item">
                        <div class="device-icon"><img src="https://iptvclient.vercel.app/tv-box.png" alt="–¢–í –ø—Ä–∏—Å—Ç–∞–≤–∫–∞"></div>
                        <div class="device-name">–ù–∞ –¢–í –ø—Ä–∏—Å—Ç–∞–≤–∫–µ</div>
                    </div>
                    <div class="device-item">
                        <div class="device-icon"><img src="https://iptvclient.vercel.app/tv.png" alt="Smart TV"></div>
                        <div class="device-name">–ù–∞ Smart TV —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–µ</div>
                    </div>
                    <div class="device-item">
                        <div class="device-icon"><img src="https://iptvclient.vercel.app/tv-tuner.png" alt="–°–ø—É—Ç–Ω–∏–∫–æ–≤—ã–π —Ç—é–Ω–µ—Ä"></div>
                        <div class="device-name">–ù–∞ —Å–ø—É—Ç–Ω–∏–∫–æ–≤–æ–º —Ç—é–Ω–µ—Ä–µ</div>
                    </div>
                    <div class="device-item">
                        <div class="device-icon"><img src="https://iptvclient.vercel.app/laptop.png" alt="–ö–æ–º–ø—å—é—Ç–µ—Ä"></div>
                        <div class="device-name">–ù–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –∏ –Ω–æ—É—Ç–±—É–∫–µ</div>
                    </div>
                </div>
            </div>

            <div class="post-auth-layout">
                <div id="playlistInfoPage" class="playlist-info-page">
                    <p class="client-greeting" id="clientNameGreeting"></p>
                    <h2 style="font-weight: 600;">–í–∞—à –ø–ª–µ–π–ª–∏—Å—Ç</h2> 
                    <p class="expiration-info" id="expirationMessage"></p>
                    <p style="color: #666; margin-bottom: 25px;">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∏–∂–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ IPTV-—Å–µ—Ä–≤–∏—Å—É –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</p>
                    <div class="playlist-link-box" id="finalPlaylistLink">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    <div class="playlist-info-actions">
                        <button id="copyLinkBtnPage" style="background: var(--system-blue);">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
                        <button id="downloadLinkBtnPage" style="background: var(--system-green);">–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</button>
                    </div>
                </div>
                <div id="paymentBlock" class="payment-block playlist-info-page">
                    <h2>–û–ø–ª–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∫–∏</h2>
                    <p class="payment-amount">–û–ø–ª–∞—Ç–∏—Ç—å 150 –≥—Ä–Ω</p>
                    <div class="card-number-display" id="cardNumberDisplay">5168752084846610</div>
                    <button class="copy-card-btn" onclick="copyToClipboard('5168752084846610', event)">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–º–µ—Ä</button>
                    <p style="color: #666; margin-top: 20px; margin-bottom: 25px; font-size: 14px;">–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã, —á—Ç–æ–±—ã –æ–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É.</p>
                    <button class="submit-btn-modern payment-btn" onclick="alert('–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ!')">–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ</button>
                </div>
            </div>
        </div>
        
        <div id="channelListPage" style="display: none;">
            <header>
                <button id="backToMainBtn">–ù–∞–∑–∞–¥</button>
                <span class="header-title">–ü–ª–µ–π–ª–∏—Å—Ç 4030 –∫–∞–Ω–∞–ª–æ–≤</span>
            </header>
            <div class="search-container">
                <input type="text" class="search-input" id="main-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –∫–∞–Ω–∞–ª–∞–º...">
            </div>
            <div class="categories" id="categories"></div>
            <div id="search-results"></div>

            <div class="modal" id="channelModal">
                <div class="modal-content">
                    <span class="close-btn" onclick="closeChannelModal()">√ó</span>
                    <h2 id="modal-title"></h2>
                    <input type="text" class="modal-search" id="modal-search" placeholder="–ü–æ–∏—Å–∫ –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...">
                    <div id="channel-list"></div>
                </div>
            </div>
        </div>
    </div>


    <div id="registrationModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('registrationModal')">&times;</span>
            <h1 style="text-align: center; margin-bottom: 20px;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
            <form id="registrationForm" onsubmit="return false;">
                <div class="input-group-modern"><input type="text" id="clientName" required placeholder=" "><label for="clientName">–í–∞—à–µ –∏–º—è</label></div>
                <div class="input-group-modern"><input type="tel" id="clientPhone" required placeholder=" "><label for="clientPhone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label></div>
                <div class="input-group-modern"><input type="password" id="clientPassword" required placeholder=" "><label for="clientPassword">–ü–∞—Ä–æ–ª—å</label></div>
                <div class="input-group-modern"><input type="password" id="clientPasswordRepeat" required placeholder=" "><label for="clientPasswordRepeat">–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label></div>
                <button type="submit" class="submit-btn-modern">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <div id="statusMessage" class="status-message"></div>
            </form>
        </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('loginModal')">&times;</span>
            <h2 style="text-align: center; margin-bottom: 20px;">–í—Ö–æ–¥</h2>
            <form id="loginForm" onsubmit="return false;">
                <div class="input-group-modern"><input type="tel" id="loginPhone" required placeholder=" "><label for="loginPhone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label></div>
                <div class="input-group-modern"><input type="password" id="loginPassword" required placeholder=" "><label for="loginPassword">–ü–∞—Ä–æ–ª—å</label></div>
                <button type="submit" id="loginBtn" class="submit-btn-modern">–í–æ–π—Ç–∏</button>
            </form>
            <div id="loginStatusMessage" class="status-message"></div>
        </div>
    </div>

    <script>
        // =================================================================
        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø GITHUB –ò VERCEL (–û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)
        // =================================================================
        const TOKEN_PARTS = ["ghp_to27A4", "Q0SrXyfBANG1", "fxQvzyhhgwrn0rm1ra"];
        const REPO_CONFIG = {
            owner: "kyiv14", repo: "moe-iptv", branch: "main",
            clientsFile: "public/clients.json",
            samplePlaylist: "https://moe-iptv.vercel.app/sample.m3u", 
            baseUrl: "https://moe-iptv.vercel.app/"
        };
        
        // --- –ö–û–ù–°–¢–ê–ù–¢–´ TELEGRAM ---
        const TELEGRAM_BOT_TOKEN = '8457795718:AAH60EaVEHhS2AM1YJy1CQUHt8NMN4d2z34';
        const TELEGRAM_CHAT_ID = '351875366';
        
        let currentClientData = null; 
        let currentPlaylistResult = null;
        
        function getGitHubToken() { return TOKEN_PARTS.join(''); }

        function getExpirationDays(paymentDate, months) {
            if (!paymentDate || !months) return "–¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç";
            const start = new Date(paymentDate);
            const durationMonths = parseInt(months, 10);
            if (isNaN(durationMonths) || durationMonths <= 0) return "–¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç";
            const expirationDate = new Date(start);
            expirationDate.setMonth(expirationDate.getMonth() + durationMonths);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            expirationDate.setHours(0, 0, 0, 0);
            const diffTime = expirationDate.getTime() - today.getTime();
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            if (diffDays > 0) return `–∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ ${diffDays} –¥–Ω.`;
            if (diffDays === 0) return "–∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —Å–µ–≥–æ–¥–Ω—è!";
            return `–∑–∞–∫–æ–Ω—á–∏–ª—Å—è ${Math.abs(diffDays)} –¥–Ω. –Ω–∞–∑–∞–¥`;
        }

        function extractPhoneNumber(phone) { return phone.replace(/\D/g, '').slice(-10); }
        function openModal(modalId) { document.getElementById(modalId).style.display = 'flex'; }
        function closeModal(modalId) { document.getElementById(modalId).style.display = 'none'; }
        function showStatus(message, type, elementId = 'statusMessage') {
            const statusEl = document.getElementById(elementId);
            statusEl.innerHTML = message;
            statusEl.className = 'status-message ' + type;
            statusEl.style.display = 'block';
        }
        function copyToClipboard(text, event) {
            event.preventDefault();
            navigator.clipboard.writeText(text).then(() => {
                alert('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞: ' + text);
            }).catch(err => console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ', err));
            return false;
        }
        function forceDownload(url, filename) {
            fetch(url).then(response => response.blob()).then(blob => {
                const blobUrl = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = blobUrl; a.download = filename;
                document.body.appendChild(a); a.click();
                setTimeout(() => { document.body.removeChild(a); window.URL.revokeObjectURL(blobUrl); }, 100);
            }).catch(error => console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞:', error));
        }
        
        function logout() {
            currentClientData = null; currentPlaylistResult = null;
            document.querySelector('.post-auth-layout').style.display = 'none';
            document.getElementById('preAuthContent').style.display = 'block';
            document.getElementById('howToConnectBlock').style.display = 'block';
            document.getElementById('whereItWorksBlock').style.display = 'block';
            const logoutBtn = document.getElementById('logoutBtn');
            logoutBtn.style.opacity = '0'; 
            setTimeout(() => {
                logoutBtn.style.display = 'none';
                ['regBtn', 'loginBtnNav'].forEach(id => {
                    const btn = document.getElementById(id);
                    btn.style.display = 'block';
                    btn.style.opacity = '1';
                });
            }, 300);
        }

        function showPlaylistPage() {
            ['preAuthContent', 'howToConnectBlock', 'whereItWorksBlock'].forEach(id => document.getElementById(id).style.display = 'none');
            document.querySelector('.post-auth-layout').style.display = 'flex';
            document.getElementById('playlistInfoPage').style.display = 'block';
            document.getElementById('paymentBlock').style.display = 'block';
            ['regBtn', 'loginBtnNav'].forEach(id => document.getElementById(id).style.display = 'none');
            const logoutBtn = document.getElementById('logoutBtn');
            logoutBtn.style.display = 'block';
            setTimeout(() => { logoutBtn.style.opacity = '1'; }, 100);
            
            document.getElementById('clientNameGreeting').textContent = `–ü—Ä–∏–≤–µ—Ç, ${currentClientData.name || '–ö–ª–∏–µ–Ω—Ç'}!`;
            document.getElementById('expirationMessage').textContent = `–í–∞—à —Ç–∞—Ä–∏—Ñ ${getExpirationDays(currentClientData.paymentDate, currentClientData.months)}.`;
            document.getElementById('finalPlaylistLink').textContent = currentPlaylistResult.isgdUrl;
            
            const tempUrl = URL.createObjectURL(new Blob([currentPlaylistResult.m3uContent], { type: 'application/x-mpegurl' }));
            document.getElementById('copyLinkBtnPage').onclick = (e) => copyToClipboard(currentPlaylistResult.isgdUrl, e);
            document.getElementById('downloadLinkBtnPage').onclick = () => forceDownload(tempUrl, `${currentPlaylistResult.m3uFilename}`);
        }

        async function getFileSha(filename) {
            const apiUrl = `https://api.github.com/repos/${REPO_CONFIG.owner}/${REPO_CONFIG.repo}/contents/${filename}`;
            try {
                const response = await fetch(apiUrl, { headers: { 'Authorization': `Bearer ${getGitHubToken()}`, 'Accept': 'application/vnd.github+json' } });
                if (response.ok) return (await response.json()).sha;
                if (response.status === 404) return null;
                throw new Error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ SHA: ${response.statusText}`);
            } catch (error) { console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ SHA:', error); return null; }
        }

        async function loadClientsFromGitHub() {
            const apiUrl = `https://api.github.com/repos/${REPO_CONFIG.owner}/${REPO_CONFIG.repo}/contents/${REPO_CONFIG.clientsFile}`;
            const response = await fetch(apiUrl, { headers: { 'Authorization': `Bearer ${getGitHubToken()}`, 'Accept': 'application/vnd.github.v3+json' } });
            if (response.ok) {
                const data = await response.json();
                const content = decodeURIComponent(escape(atob(data.content)));
                return { clients: JSON.parse(content) || [], sha: data.sha };
            }
            if (response.status === 404) return { clients: [], sha: null };
            throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${response.statusText}`);
        }

        async function createIsGdShortUrl(phone) {
            const cleanPhone = extractPhoneNumber(phone);
            const longUrl = `${REPO_CONFIG.baseUrl}${cleanPhone}.m3u`;
            try {
                const apiUrl = `https://is.gd/create.php?format=json&url=${encodeURIComponent(longUrl)}&shorturl=${cleanPhone}`;
                const response = await fetch(apiUrl);
                if (!response.ok) throw new Error("–°–µ—Ä–≤–∏—Å is.gd –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.");
                const data = await response.json();
                return data.errorcode ? `https://is.gd/${cleanPhone}` : data.shorturl;
            } catch (error) { console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è is.gd —Å—Å—ã–ª–∫–∏:', error); return longUrl; }
        }

        async function createPlaylist(phone, key) {
            const cleanPhone = extractPhoneNumber(phone);
            if (cleanPhone.length < 10) throw new Error("–ù–æ–º–µ—Ä –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 10 —Ü–∏—Ñ—Ä.");
            const filename = `public/${cleanPhone}.m3u`;
            const response = await fetch(REPO_CONFIG.samplePlaylist);
            if (!response.ok) throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—Ä–∞–∑–µ—Ü –ø–ª–µ–π–ª–∏—Å—Ç–∞ sample.m3u.");
            let content = await response.text();
            content = content.replace(/\/iptv\/\w+\//g, `/iptv/${key}/`);
            const sha = await getFileSha(filename);
            const uploadResponse = await fetch(`https://api.github.com/repos/${REPO_CONFIG.owner}/${REPO_CONFIG.repo}/contents/${filename}`, {
                method: 'PUT',
                headers: { 'Authorization': `Bearer ${getGitHubToken()}`, 'Content-Type': 'application/json', 'Accept': 'application/vnd.github+json' },
                body: JSON.stringify({ message: `–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞: ${cleanPhone}`, content: btoa(unescape(encodeURIComponent(content))), branch: REPO_CONFIG.branch, sha: sha })
            });
            if (!uploadResponse.ok) throw new Error((await uploadResponse.json()).message || "–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞");
            const isgdUrl = await createIsGdShortUrl(phone);
            return { isgdUrl, m3uFilename: `${cleanPhone}.m3u`, m3uContent: content };
        }
        
        // --- –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø: –û–¢–ü–†–ê–í–ö–ê –í TELEGRAM –° –î–ê–¢–û–ô ---
        async function sendRegistrationToTelegram(clientData) {
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
            const regDate = new Date(clientData.registration_date).toLocaleDateString('ru-RU', { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' });
            
            const message = `üîî –ù–û–í–ê–Ø –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø! üîî\n\n–ò–º—è: ${clientData.name}\n–¢–µ–ª–µ—Ñ–æ–Ω: ${clientData.phone}\n–î–∞—Ç–∞: ${regDate}`;
            const apiUrl = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage?chat_id=${TELEGRAM_CHAT_ID}&text=${encodeURIComponent(message)}&parse_mode=HTML`;
            
            try {
                const response = await fetch(apiUrl, { method: 'POST' });
                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('–û—à–∏–±–∫–∞ Telegram API:', errorData);
                }
                console.log('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Telegram.');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ Telegram:', error);
            }
        }
        // --- –ö–û–ù–ï–¶ –û–ë–ù–û–í–õ–ï–ù–ù–û–ô –§–£–ù–ö–¶–ò–ò ---

        async function saveClientData(client) {
            let { clients: currentClients, sha } = await loadClientsFromGitHub();
            if (currentClients.some(c => c.phone === client.phone)) throw new Error("–ö–ª–∏–µ–Ω—Ç —Å —Ç–∞–∫–∏–º –Ω–æ–º–µ—Ä–æ–º —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω.");
            currentClients.push(client);
            const response = await fetch(`https://api.github.com/repos/${REPO_CONFIG.owner}/${REPO_CONFIG.repo}/contents/${REPO_CONFIG.clientsFile}`, {
                method: 'PUT',
                headers: { 'Authorization': `Bearer ${getGitHubToken()}`, 'Content-Type': 'application/json', 'Accept': 'application/vnd.github+json' },
                body: JSON.stringify({ message: `–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç: ${client.name}`, content: btoa(unescape(encodeURIComponent(JSON.stringify(currentClients)))), branch: REPO_CONFIG.branch, sha: sha })
            });
            if (!response.ok) throw new Error((await response.json()).message || "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞.");
            return true;
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('registrationForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('clientName').value.trim();
                const phone = document.getElementById('clientPhone').value.trim();
                const password = document.getElementById('clientPassword').value;
                const passwordRepeat = document.getElementById('clientPasswordRepeat').value;
                const cleanPhoneDigits = extractPhoneNumber(phone);
                
                if (!name || !phone || !password || password !== passwordRepeat || password.length < 6 || cleanPhoneDigits.length < 10) {
                    showStatus("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—è: –∑–∞–ø–æ–ª–Ω–µ–Ω—ã, –ø–∞—Ä–æ–ª–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç (–º–∏–Ω. 6 —Å–∏–º–≤.), —Ç–µ–ª–µ—Ñ–æ–Ω (–º–∏–Ω. 10 —Ü–∏—Ñ—Ä).", "error");
                    return;
                }
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞, –≤–∫–ª—é—á–∞—è –¥–∞—Ç—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                const newClient = { name, phone: cleanPhoneDigits, password, key: '0000000000', paymentDate: new Date().toISOString().split('T')[0], months: '1', registration_date: new Date().toISOString() };
                try {
                    // --- –í–´–ó–û–í –û–ë–ù–û–í–õ–ï–ù–ù–û–ô –§–£–ù–ö–¶–ò–ò TELEGRAM ---
                    await sendRegistrationToTelegram(newClient);
                    // --- –ö–û–ù–ï–¶ –í–´–ó–û–í–ê ---
                    
                    currentPlaylistResult = await createPlaylist(phone, newClient.key);
                    await saveClientData(newClient);
                    currentClientData = newClient;
                    document.getElementById('registrationForm').reset();
                    closeModal('registrationModal');
                    document.getElementById('loginPhone').value = phone; 
                    document.getElementById('loginPassword').value = password; 
                    openModal('loginModal');
                } catch (error) { showStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, "error"); console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error); }
            });

            document.getElementById('loginForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const loginPhone = document.getElementById('loginPhone').value.trim();
                const loginPassword = document.getElementById('loginPassword').value;
                const cleanLoginPhoneDigits = extractPhoneNumber(loginPhone);
                if (!loginPhone || !loginPassword) { showStatus('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è.', "error", 'loginStatusMessage'); return; }
                try {
                    const { clients } = await loadClientsFromGitHub();
                    const client = clients.find(c => c.phone === cleanLoginPhoneDigits && c.password === loginPassword);
                    if (client) {
                        currentClientData = client;
                        currentPlaylistResult = await createPlaylist(loginPhone, client.key || '0000000000');
                        closeModal('loginModal');
                        showPlaylistPage();
                    } else { showStatus('–ù–µ–≤–µ—Ä–Ω—ã–π –Ω–æ–º–µ—Ä –∏–ª–∏ –ø–∞—Ä–æ–ª—å.', "error", 'loginStatusMessage'); }
                } catch (error) { showStatus(`‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ${error.message}`, "error", 'loginStatusMessage'); console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error); }
            });
            
            // --- –ù–û–í–´–ô –ö–û–î: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ ---
            document.getElementById('showChannelListBtn').addEventListener('click', function() {
                document.getElementById('mainPageContent').style.display = 'none';
                document.getElementById('channelListPage').style.display = 'block';
                document.getElementById('authButtonsContainer').style.display = 'none';
                document.querySelector('.admin-button-container').style.display = 'none';
            });
            document.getElementById('backToMainBtn').addEventListener('click', function() {
                document.getElementById('channelListPage').style.display = 'none';
                document.getElementById('mainPageContent').style.display = 'block';
                document.getElementById('authButtonsContainer').style.display = 'flex';
                document.querySelector('.admin-button-container').style.display = 'block';
            });
        });

        window.openModal = openModal;
        window.closeModal = closeModal;
        window.logout = logout;
    </script>
    
    <script>
        // =================================================================
        // –°–ö–†–ò–ü–¢ –î–õ–Ø –°–¢–†–ê–ù–ò–¶–´ –°–ü–ò–°–ö–ê –ö–ê–ù–ê–õ–û–í (–∏–∑ index01.html)
        // =================================================================
        (function() {
            const url = "https://moe-iptv.vercel.app/moe.m3u";
            const categoriesEl = document.getElementById('categories');
            const searchResultsEl = document.getElementById('search-results');
            const channelModal = document.getElementById('channelModal');
            const modalTitle = document.getElementById('modal-title');
            const channelList = document.getElementById('channel-list');
            const mainSearch = document.getElementById('main-search');
            const modalSearch = document.getElementById('modal-search');

            let dataByGroup = {};
            let allChannels = [];
            let allCategories = [];

            window.closeChannelModal = function() {
                channelModal.style.display = 'none';
            }

            async function fetchAndParseM3U() {
                try {
                    const res = await fetch(url);
                    if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
                    const text = await res.text();
                    const lines = text.split('\n');
                    let currentInfo = '';
                    let currentGroup = '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏';

                    for (let i = 0; i < lines.length; i++) {
                        const line = lines[i].trim();
                        if (line.startsWith('#EXTINF')) { currentInfo = line; } 
                        else if (line.startsWith('#EXTGRP')) { currentGroup = line.replace('#EXTGRP:', '').trim(); } 
                        else if (line && !line.startsWith('#')) {
                            const titleMatch = currentInfo.match(/,(.*)$/);
                            const title = titleMatch ? titleMatch[1] : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞–Ω–∞–ª';
                            if (!dataByGroup[currentGroup]) dataByGroup[currentGroup] = [];
                            const channelData = { title, group: currentGroup, url: line };
                            dataByGroup[currentGroup].push(channelData);
                            allChannels.push(channelData);
                            currentGroup = '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏'; // Reset group for next entry
                        }
                    }
                    allCategories = Object.keys(dataByGroup).sort();
                    renderCategories();
                } catch (error) {
                    console.error("Failed to fetch and parse M3U file:", error);
                    categoriesEl.innerHTML = "<p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>";
                }
            }

            function renderCategories() {
                categoriesEl.innerHTML = '';
                searchResultsEl.innerHTML = '';
                categoriesEl.style.display = 'grid';
                allCategories.forEach(group => {
                    const count = dataByGroup[group].length;
                    const el = document.createElement('div');
                    el.className = 'category';
                    el.innerHTML = `<div class="category-name">${group}</div><div class="category-count">–ö–∞–Ω–∞–ª–æ–≤: ${count}</div>`;
                    el.onclick = () => openChannelModal(group);
                    categoriesEl.appendChild(el);
                });
            }

            function openChannelModal(group) {
                modalTitle.textContent = group;
                channelList.innerHTML = '';
                dataByGroup[group].forEach(channel => {
                    const ch = document.createElement('div');
                    ch.className = 'channel';
                    ch.textContent = channel.title;
                    channelList.appendChild(ch);
                });
                channelModal.style.display = 'flex';
                modalSearch.value = '';
                modalSearch.focus();
                modalSearch.oninput = function() {
                    const searchTerm = this.value.toLowerCase();
                    channelList.querySelectorAll('.channel').forEach(channel => {
                        channel.style.display = channel.textContent.toLowerCase().includes(searchTerm) ? 'block' : 'none';
                    });
                };
            }

            mainSearch.oninput = function() {
                const searchTerm = this.value.toLowerCase().trim();
                if (searchTerm === '') { renderCategories(); return; }
                categoriesEl.style.display = 'none';
                searchResultsEl.innerHTML = '';
                const foundChannels = allChannels.filter(channel => channel.title.toLowerCase().includes(searchTerm));
                if (foundChannels.length === 0) {
                    searchResultsEl.innerHTML = '<div style="padding: 2rem; text-align: center; font-size: 1.2rem; color: var(--text-light);">–ö–∞–Ω–∞–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                    return;
                }
                foundChannels.forEach(channel => {
                    const el = document.createElement('div');
                    el.className = 'channel-result';
                    el.innerHTML = `<div>${channel.title}</div><div class="channel-category">${channel.group}</div>`;
                    el.onclick = () => {
                        openChannelModal(channel.group);
                        setTimeout(() => {
                            channelList.querySelectorAll('.channel').forEach(ch => {
                                if (ch.textContent === channel.title) {
                                    ch.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                    ch.style.backgroundColor = 'rgba(0, 123, 255, 0.1)';
                                    setTimeout(() => ch.style.backgroundColor = '', 2000);
                                }
                            });
                        }, 100);
                    };
                    searchResultsEl.appendChild(el);
                });
            };

            window.onclick = function(e) {
                if (e.target === channelModal) closeChannelModal();
            };
            window.onkeydown = function(e) {
                if (e.key === "Escape" && channelModal.style.display === 'flex') closeChannelModal();
            }
            fetchAndParseM3U();
        })();
    </script>
</body>
</html>